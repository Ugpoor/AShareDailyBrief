Traceback (most recent call last):
  File "/Users/mac/anaconda3/lib/python3.11/site-packages/jupyter_cache/executors/utils.py", line 58, in single_nb_execution
    executenb(
  File "/Users/mac/anaconda3/lib/python3.11/site-packages/nbclient/client.py", line 1305, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mac/anaconda3/lib/python3.11/site-packages/jupyter_core/utils/__init__.py", line 173, in wrapped
    return loop.run_until_complete(inner)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mac/anaconda3/lib/python3.11/asyncio/base_events.py", line 653, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/mac/anaconda3/lib/python3.11/site-packages/nbclient/client.py", line 705, in async_execute
    await self.async_execute_cell(
  File "/Users/mac/anaconda3/lib/python3.11/site-packages/nbclient/client.py", line 1058, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "/Users/mac/anaconda3/lib/python3.11/site-packages/nbclient/client.py", line 914, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
from selenium import webdriver
from selenium.webdriver.chrome.service import Service
from webdriver_manager.chrome import ChromeDriverManager
from PIL import Image
import time

# 使用webdriver_manager自动下载ChromeDriver
service = Service(ChromeDriverManager().install())
options = webdriver.ChromeOptions()
options.add_argument('--headless')  # 无头模式，不打开浏览器窗口
options.add_argument('--no-sandbox')
options.add_argument('--disable-dev-shm-usage')

# 初始化浏览器
driver = webdriver.Chrome(service=service, options=options)

try:
    # 打开新浪财经首页
    driver.get('https://finance.sina.com.cn')

    # 暂停几秒钟以确保页面完全加载
    time.sleep(5)

    # 截图保存为文件
    driver.save_screenshot('sina.png')

    # 打开截图并显示
    image = Image.open('sina.png')
    image.show()

finally:
    # 关闭浏览器
    driver.quit()

------------------


[0;31m---------------------------------------------------------------------------[0m
[0;31mOSError[0m                                   Traceback (most recent call last)
Cell [0;32mIn[2], line 15[0m
[1;32m     12[0m options[38;5;241m.[39madd_argument([38;5;124m'[39m[38;5;124m--disable-dev-shm-usage[39m[38;5;124m'[39m)
[1;32m     14[0m [38;5;66;03m# 初始化浏览器[39;00m
[0;32m---> 15[0m driver [38;5;241m=[39m webdriver[38;5;241m.[39mChrome(service[38;5;241m=[39mservice, options[38;5;241m=[39moptions)
[1;32m     17[0m [38;5;28;01mtry[39;00m:
[1;32m     18[0m     [38;5;66;03m# 打开新浪财经首页[39;00m
[1;32m     19[0m     driver[38;5;241m.[39mget([38;5;124m'[39m[38;5;124mhttps://finance.sina.com.cn[39m[38;5;124m'[39m)

File [0;32m~/anaconda3/lib/python3.11/site-packages/selenium/webdriver/chrome/webdriver.py:45[0m, in [0;36mWebDriver.__init__[0;34m(self, options, service, keep_alive)[0m
[1;32m     42[0m service [38;5;241m=[39m service [38;5;28;01mif[39;00m service [38;5;28;01melse[39;00m Service()
[1;32m     43[0m options [38;5;241m=[39m options [38;5;28;01mif[39;00m options [38;5;28;01melse[39;00m Options()
[0;32m---> 45[0m [38;5;28msuper[39m()[38;5;241m.[39m[38;5;21m__init__[39m(
[1;32m     46[0m     browser_name[38;5;241m=[39mDesiredCapabilities[38;5;241m.[39mCHROME[[38;5;124m"[39m[38;5;124mbrowserName[39m[38;5;124m"[39m],
[1;32m     47[0m     vendor_prefix[38;5;241m=[39m[38;5;124m"[39m[38;5;124mgoog[39m[38;5;124m"[39m,
[1;32m     48[0m     options[38;5;241m=[39moptions,
[1;32m     49[0m     service[38;5;241m=[39mservice,
[1;32m     50[0m     keep_alive[38;5;241m=[39mkeep_alive,
[1;32m     51[0m )

File [0;32m~/anaconda3/lib/python3.11/site-packages/selenium/webdriver/chromium/webdriver.py:50[0m, in [0;36mChromiumDriver.__init__[0;34m(self, browser_name, vendor_prefix, options, service, keep_alive)[0m
[1;32m     47[0m [38;5;28mself[39m[38;5;241m.[39mservice [38;5;241m=[39m service
[1;32m     49[0m [38;5;28mself[39m[38;5;241m.[39mservice[38;5;241m.[39mpath [38;5;241m=[39m DriverFinder[38;5;241m.[39mget_path([38;5;28mself[39m[38;5;241m.[39mservice, options)
[0;32m---> 50[0m [38;5;28mself[39m[38;5;241m.[39mservice[38;5;241m.[39mstart()
[1;32m     52[0m executor [38;5;241m=[39m ChromiumRemoteConnection(
[1;32m     53[0m     remote_server_addr[38;5;241m=[39m[38;5;28mself[39m[38;5;241m.[39mservice[38;5;241m.[39mservice_url,
[1;32m     54[0m     browser_name[38;5;241m=[39mbrowser_name,
[0;32m   (...)[0m
[1;32m     57[0m     ignore_proxy[38;5;241m=[39moptions[38;5;241m.[39m_ignore_local_proxy,
[1;32m     58[0m )
[1;32m     60[0m [38;5;28;01mtry[39;00m:

File [0;32m~/anaconda3/lib/python3.11/site-packages/selenium/webdriver/common/service.py:98[0m, in [0;36mService.start[0;34m(self)[0m
[1;32m     91[0m [38;5;28;01mdef[39;00m [38;5;21mstart[39m([38;5;28mself[39m) [38;5;241m-[39m[38;5;241m>[39m [38;5;28;01mNone[39;00m:
[1;32m     92[0m [38;5;250m    [39m[38;5;124;03m"""Starts the Service.[39;00m
[1;32m     93[0m 
[1;32m     94[0m [38;5;124;03m    :Exceptions:[39;00m
[1;32m     95[0m [38;5;124;03m     - WebDriverException : Raised either when it can't start the service[39;00m
[1;32m     96[0m [38;5;124;03m       or when it can't connect to the service[39;00m
[1;32m     97[0m [38;5;124;03m    """[39;00m
[0;32m---> 98[0m     [38;5;28mself[39m[38;5;241m.[39m_start_process([38;5;28mself[39m[38;5;241m.[39m_path)
[1;32m    100[0m     count [38;5;241m=[39m [38;5;241m0[39m
[1;32m    101[0m     [38;5;28;01mwhile[39;00m [38;5;28;01mTrue[39;00m:

File [0;32m~/anaconda3/lib/python3.11/site-packages/selenium/webdriver/common/service.py:208[0m, in [0;36mService._start_process[0;34m(self, path)[0m
[1;32m    205[0m         start_info[38;5;241m.[39mdwFlags [38;5;241m=[39m subprocess[38;5;241m.[39mCREATE_NEW_CONSOLE [38;5;241m|[39m subprocess[38;5;241m.[39mSTARTF_USESHOWWINDOW
[1;32m    206[0m         start_info[38;5;241m.[39mwShowWindow [38;5;241m=[39m subprocess[38;5;241m.[39mSW_HIDE
[0;32m--> 208[0m     [38;5;28mself[39m[38;5;241m.[39mprocess [38;5;241m=[39m subprocess[38;5;241m.[39mPopen(
[1;32m    209[0m         cmd,
[1;32m    210[0m         env[38;5;241m=[39m[38;5;28mself[39m[38;5;241m.[39menv,
[1;32m    211[0m         close_fds[38;5;241m=[39mclose_file_descriptors,
[1;32m    212[0m         stdout[38;5;241m=[39m[38;5;28mself[39m[38;5;241m.[39mlog_output,
[1;32m    213[0m         stderr[38;5;241m=[39m[38;5;28mself[39m[38;5;241m.[39mlog_output,
[1;32m    214[0m         stdin[38;5;241m=[39mPIPE,
[1;32m    215[0m         creationflags[38;5;241m=[39m[38;5;28mself[39m[38;5;241m.[39mcreation_flags,
[1;32m    216[0m         startupinfo[38;5;241m=[39mstart_info,
[1;32m    217[0m         [38;5;241m*[39m[38;5;241m*[39m[38;5;28mself[39m[38;5;241m.[39mpopen_kw,
[1;32m    218[0m     )
[1;32m    219[0m     logger[38;5;241m.[39mdebug(
[1;32m    220[0m         [38;5;124m"[39m[38;5;124mStarted executable: `[39m[38;5;132;01m%s[39;00m[38;5;124m` in a child process with pid: [39m[38;5;132;01m%s[39;00m[38;5;124m using [39m[38;5;132;01m%s[39;00m[38;5;124m to output [39m[38;5;132;01m%s[39;00m[38;5;124m"[39m,
[1;32m    221[0m         [38;5;28mself[39m[38;5;241m.[39m_path,
[0;32m   (...)[0m
[1;32m    224[0m         [38;5;28mself[39m[38;5;241m.[39mlog_output,
[1;32m    225[0m     )
[1;32m    226[0m [38;5;28;01mexcept[39;00m [38;5;167;01mTypeError[39;00m:

File [0;32m~/anaconda3/lib/python3.11/subprocess.py:1026[0m, in [0;36mPopen.__init__[0;34m(self, args, bufsize, executable, stdin, stdout, stderr, preexec_fn, close_fds, shell, cwd, env, universal_newlines, startupinfo, creationflags, restore_signals, start_new_session, pass_fds, user, group, extra_groups, encoding, errors, text, umask, pipesize, process_group)[0m
[1;32m   1022[0m         [38;5;28;01mif[39;00m [38;5;28mself[39m[38;5;241m.[39mtext_mode:
[1;32m   1023[0m             [38;5;28mself[39m[38;5;241m.[39mstderr [38;5;241m=[39m io[38;5;241m.[39mTextIOWrapper([38;5;28mself[39m[38;5;241m.[39mstderr,
[1;32m   1024[0m                     encoding[38;5;241m=[39mencoding, errors[38;5;241m=[39merrors)
[0;32m-> 1026[0m     [38;5;28mself[39m[38;5;241m.[39m_execute_child(args, executable, preexec_fn, close_fds,
[1;32m   1027[0m                         pass_fds, cwd, env,
[1;32m   1028[0m                         startupinfo, creationflags, shell,
[1;32m   1029[0m                         p2cread, p2cwrite,
[1;32m   1030[0m                         c2pread, c2pwrite,
[1;32m   1031[0m                         errread, errwrite,
[1;32m   1032[0m                         restore_signals,
[1;32m   1033[0m                         gid, gids, uid, umask,
[1;32m   1034[0m                         start_new_session, process_group)
[1;32m   1035[0m [38;5;28;01mexcept[39;00m:
[1;32m   1036[0m     [38;5;66;03m# Cleanup if the child failed starting.[39;00m
[1;32m   1037[0m     [38;5;28;01mfor[39;00m f [38;5;129;01min[39;00m [38;5;28mfilter[39m([38;5;28;01mNone[39;00m, ([38;5;28mself[39m[38;5;241m.[39mstdin, [38;5;28mself[39m[38;5;241m.[39mstdout, [38;5;28mself[39m[38;5;241m.[39mstderr)):

File [0;32m~/anaconda3/lib/python3.11/subprocess.py:1950[0m, in [0;36mPopen._execute_child[0;34m(self, args, executable, preexec_fn, close_fds, pass_fds, cwd, env, startupinfo, creationflags, shell, p2cread, p2cwrite, c2pread, c2pwrite, errread, errwrite, restore_signals, gid, gids, uid, umask, start_new_session, process_group)[0m
[1;32m   1948[0m     [38;5;28;01mif[39;00m errno_num [38;5;241m!=[39m [38;5;241m0[39m:
[1;32m   1949[0m         err_msg [38;5;241m=[39m os[38;5;241m.[39mstrerror(errno_num)
[0;32m-> 1950[0m     [38;5;28;01mraise[39;00m child_exception_type(errno_num, err_msg, err_filename)
[1;32m   1951[0m [38;5;28;01mraise[39;00m child_exception_type(err_msg)

[0;31mOSError[0m: [Errno 8] Exec format error: '/Users/mac/.wdm/drivers/chromedriver/mac64/130.0.6723.91/chromedriver-mac-x64/THIRD_PARTY_NOTICES.chromedriver'

